{
    "products": [
      {
        "name": "deploy-arch-secrets-manager-custom-credentials-engine",
        "label": "Cloud automation for Secrets Manager custom credentials engine",
        "product_kind": "solution",
        "tags": [
            "ibm_created",
            "target_terraform",
            "terraform",
            "solution",
            "security",
            "converged_infra"
        ],
        "keywords": [
            "Custom credentials engine",
            "Secrets Manager",
            "IaC",
            "infrastructure as code",
            "terraform",
            "solution"
        ],
        "short_description": "Creates and configures a Secrets Manager custom credentials engine.",
        "long_description": "This deployable architecture is used to provision and configure a custom credentials engine that will be used to store [custom credential secrets](https://cloud.ibm.com/docs/secrets-manager?topic=secrets-manager-custom-credentials&interface=ui) for external systems in IBM Secrets Manager service. It creates an IAM Credentials secret, a service ID and service policy that will allow the job running in code engin to access secrets manager to update the custom secret. The architecture also creates an IAM service authorization between secrets manager and code engine project. In order to use this deployable architecture make sure a secrets manager instance is created with IAM credentials engine configured or if [Cloud automation for Secrets Manager](https://github.com/terraform-ibm-modules/terraform-ibm-secrets-manager) is being used then [skip_iam_authorization_policy](https://github.com/terraform-ibm-modules/terraform-ibm-secrets-manager/blob/main/variables.tf#L58) is set to true.\n\nℹ️ This Terraform-based automation is part of a broader suite of IBM-maintained Infrastructure as Code (IaC) assets, each following the naming pattern \"Cloud automation for *servicename*\" and focusing on single IBM Cloud service. These single-service deployable architectures can be used on their own to streamline and automate service deployments through an [IaC approach](https://cloud.ibm.com/docs/secure-enterprise?topic=secure-enterprise-understanding-projects), or assembled together into a broader [automated IaC stack](https://cloud.ibm.com/docs/secure-enterprise?topic=secure-enterprise-config-stack) to automate the deployment of an end-to-end solution architecture.",
        "offering_docs_url": "https://github.com/terraform-ibm-modules/terraform-ibm-secrets-manager-custom-credentials-engine/blob/main/README.md",
        "offering_icon_url": "https://raw.githubusercontent.com/terraform-ibm-modules/terraform-ibm-secrets-manager-custom-credentials-engine/refs/heads/13662-custom-engine/images/secrets_manager_custom_credentials_engine.svg",
        "provider_name": "IBM",
        "features": [
            {
                "title": "IAM service authorization",
                "description": "Creates a [service authorization policy](https://cloud.ibm.com/docs/account?topic=account-serviceauth&interface=ui) between secrets manager as source and code engine project as target."
            },
            {
                "title": "IAM credentials secret",
                "description": "Creates an [IAM credentials secret](https://cloud.ibm.com/docs/secrets-manager?topic=secrets-manager-iam-credentials&interface=terraform) to allow code engine job to access/update secrets in secrets manager instance."
            },
            {
                "title": "Custom credentials engine",
                "description": "Creates a [custom credentials engine](https://cloud.ibm.com/docs/secrets-manager?topic=secrets-manager-custom-credentials-config&interface=terraform) configuration which acts as a back-end for custom credentials secret."
            }
        ],
        "support_details": "This product is in the community registry, as such support is handled through the originated repo. If you experience issues please open an issue in that repository [here](https://github.com/terraform-ibm-modules/terraform-ibm-secrets-manager-custom-credentials-engine/issues). Please note this product is not supported via the IBM Cloud Support Center.",
        "flavors": [
          {
            "label": "Fully configurable",
            "name": "fully-configurable",
            "index": 1,
            "install_type": "fullstack",
            "working_directory": "solutions/fully-configurable",
            "compliance": {
              "authority": "scc-v3",
              "profiles": [
                {
                  "profile_name": "IBM Cloud Framework for Financial Services",
                  "profile_version": "1.7.0"
                }
              ]
            },
            "configuration": [
                {
                    "key": "ibmcloud_api_key"
                },
                {
                    "key": "provider_visibility",
                    "options": [
                        {
                            "displayname": "private",
                            "value": "private"
                        },
                        {
                            "displayname": "public",
                            "value": "public"
                        },
                        {
                            "displayname": "public-and-private",
                            "value": "public-and-private"
                        }
                    ],
                    "hidden": true
                },
                {
              "key": "secrets_manager_region",
              "required": true,
              "virtual": true,
              "default_value": "us-south",
              "description": "The region to provision a new Secrets Manager instance in.",
              "options": [
                {
                  "displayname": "Osaka (jp-osa)",
                  "value": "jp-osa"
                },
                {
                  "displayname": "Sydney (au-syd)",
                  "value": "au-syd"
                },
                {
                  "displayname": "Tokyo (jp-tok)",
                  "value": "jp-tok"
                },
                {
                  "displayname": "Frankfurt (eu-de)",
                  "value": "eu-de"
                },
                {
                  "displayname": "London (eu-gb)",
                  "value": "eu-gb"
                },
                {
                  "displayname": "Madrid (eu-es)",
                  "value": "eu-es"
                },
                {
                  "displayname": "Dallas (us-south)",
                  "value": "us-south"
                },
                {
                  "displayname": "Toronto (ca-tor)",
                  "value": "ca-tor"
                },
                {
                  "displayname": "Washington DC (us-east)",
                  "value": "us-east"
                },
                {
                  "displayname": "Sao Paulo (br-sao)",
                  "value": "br-sao"
                }
              ]
            },
            {
              "key": "secrets_manager_service_plan",
              "required": true,
              "virtual": true,
              "type": "string",
              "options": [
                {
                  "displayname": "Standard",
                  "value": "standard"
                },
                {
                  "displayname": "Trial",
                  "value": "trial"
                }
              ],
              "default_value": "__NOT_SET__",
              "description": "The pricing plan to use when provisioning a Secrets Manager instance. Possible values: `standard`, `trial`. You can create only one Trial instance of Secrets Manager per account. Before you can create a new Trial instance, you must delete the existing Trial instance and its reclamation. [Learn more](https://cloud.ibm.com/docs/secrets-manager?topic=secrets-manager-create-instance&interface=ui#upgrade-instance-standard)."
            },
                {
                    "key": "existing_secrets_manager_crn",
                    "required": true
                },
                {
                    "key": "prefix",
                    "required": true
                },
                {
                    "key": "custom_credential_engine_name",
                    "required":true
                },
                {
                    "key": "code_engine_project_id",
                    "required":true
                },
                {
                    "key": "code_engine_job_name",
                    "required":true
                },
                {
                    "key": "code_engine_region",
                    "required":true
                },
                {
                    "key": "service_id_name",
                    "required":true
                },
                {
                    "key": "iam_credential_secret_name",
                    "required":true
                },
                {
                    "key": "task_timeout"
                },
                {
                    "key": "endpoint_type",
                    "options": [
                    {
                        "displayname": "private",
                        "value": "private"
                    },
                    {
                        "displayname": "public",
                        "value": "public"
                    }
                    ]
                },
                {
                    "key": "iam_credential_secret_group_id"
                },
                {
                    "key": "iam_credential_secret_ttl"
                },
                {
                    "key": "iam_credential_secret_auto_rotation_interval"
                },
                {
                    "key": "iam_credential_secret_auto_rotation_unit"
                },
                {
                    "key": "iam_credential_secret_labels"
                }
            ],
            "iam_permissions": [
                {
                    "service_name": "secrets-manager",
                    "role_crns": [
                        "crn:v1:bluemix:public:iam::::role:Administrator",
                        "crn:v1:bluemix:public:iam::::serviceRole:Manager"
                    ]
                }
            ],
            "architecture": {
                "descriptions": "This architecture supports creating and configuring a Secrets Manager Custom Credentials Engine.",
                "features": [
                    {
                        "title": " ",
                        "description": "Configured to use IBM secure-by-default standards, but can be edited to fit your use case."
                    }
                ],
                "diagrams": [
                    {
                        "diagram": {
                            "caption": "Secrets Manager Custom Credentials Engine",
                            "url": "https://raw.githubusercontent.com/terraform-ibm-modules/terraform-ibm-secrets-manager-custom-credentials-engine/refs/heads/13662-custom-engine/reference-architecture/secrets_manager_custom_credentials_engine.svg",
                            "type": "image/svg+xml"
                        },
                        "description": "This architecture automates the setup of IBM Secrets Manager Custom Credentials Engine. The modular design includes the creation of a service authorization policy and IAM credentials secrets that are needed for provisioning the engine configuration."
                    }
                ]
            },
            "dependencies": [
            {
              "name": "deploy-arch-ibm-secrets-manager",
              "description": "Create a new Secrets Manager instance.",
              "id": "6d6ebc76-7bbd-42f5-8bc7-78f4fabd5944-global",
              "version": "v2.6.3",
              "flavors": [
                "fully-configurable"
              ],
              "catalog_id": "7a4d68b4-cf8b-40cd-a3d1-f49aff526eb3",
              "optional": true,
              "on_by_default": true,
              "input_mapping": [
                {
                  "dependency_input": "prefix",
                  "version_input": "prefix",
                  "reference_version": true
                },
                {
                  "dependency_input": "region",
                  "version_input": "secrets_manager_region",
                  "reference_version": true
                },
                {
                  "dependency_input": "service_plan",
                  "version_input": "secrets_manager_service_plan",
                  "reference_version": true
                },
                {
                  "dependency_output": "secrets_manager_crn",
                  "version_input": "existing_secrets_manager_crn"
                }
              ]
            }
          ],
          "dependency_version_2": true,
          "terraform_version": "1.10.5"
          }
        ]
      }
    ]
}
